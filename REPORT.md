# –ó–∞–¥–∞–Ω–∏–µ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ CNN –∏ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–µ—Ç–µ–π (40 –±–∞–ª–ª–æ–≤)
## 1.1 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ MNIST (20 –±–∞–ª–ª–æ–≤)
–°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ MNIST:
- –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å (3-4 —Å–ª–æ—è)
- –ü—Ä–æ—Å—Ç–∞—è CNN (2-3 conv —Å–ª–æ—è)
- CNN —Å Residual Block

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\
batch_size: 128\
epochs: 10\
optimizer: Adam\
learning_rate: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–ª—è Adam (–æ–±—ã—á–Ω–æ 0.001)\
loss_function: CrossEntropyLoss\
device: cuda (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞), –∏–Ω–∞—á–µ cpu\
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π:\
FCNet: 4 —Å–ª–æ—è, —Ä–∞–∑–º–µ—Ä—ã: 28√ó28 ‚Üí 512 ‚Üí 256 ‚Üí 128 ‚Üí 10\
SimpleCNN: 3 —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è —Å MaxPooling, –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏ 128 ‚Üí 10\
ResNetLike: 1 —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π + 2 residual –±–ª–æ–∫–∞, adaptive avg pooling, fc 128 ‚Üí 10
- –°—Ä–∞–≤–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ train –∏ test –º–Ω–æ–∂–µ—Å—Ç–≤–∞—Ö
```
–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ train –º–Ω–æ–∂–µ—Å—Ç–≤–µ:
FCNet: 0.9954
SimpleCNN: 0.9968
ResNetLike: 0.9983

–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ test –º–Ω–æ–∂–µ—Å—Ç–≤–µ:
FCNet: 0.9806
SimpleCNN: 0.9911
ResNetLike: 0.9905
```

- –ò–∑–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
```
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Å–µ–∫):
FCNet: 81.64
SimpleCNN: 280.84
ResNetLike: 591.11

–í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (—Å–µ–∫):
FCNet: 0.0010
SimpleCNN: 0.0200
ResNetLike: 0.0300
```
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è

**Test accuracy**
![](plots/mnist_comparison/test_acc.png)

**Train accuracy**
![](plots/mnist_comparison/train_acc.png)

- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
FCNet: 567434           # –°–∞–º–∞—è –±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑-–∑–∞ –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ–µ–≤ (512, 256, 128)
SimpleCNN: 241546       # –ú–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–∞–∫ –∫–∞–∫ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä sharing
ResNetLike: 290058      # –ù–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —á–µ–º SimpleCNN, –∑–∞ —Å—á–µ—Ç residual –±–ª–æ–∫–æ–≤ –∏ batch normalization; –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–ª—É–±–∂–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ
```

## 1.2 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ CIFAR-10 (20 –±–∞–ª–ª–æ–≤)
–°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ CIFAR-10:
- –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å (–≥–ª—É–±–æ–∫–∞—è)
- CNN —Å Residual –±–ª–æ–∫–∞–º–∏
- CNN —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π –∏ Residual –±–ª–æ–∫–∞–º–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\
batch_size: 128\
epochs: 10\
optimizer: Adam –∏–ª–∏ SGD (momentum=0.9)\
learning_rate: 0.001 (Adam) –∏–ª–∏ 0.1 (SGD, —Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ–º –ø–æ —ç–ø–æ—Ö–∞–º)\
weight_decay: 1e-4 (–¥–ª—è ResNet, —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è)\
dropout: 0.3‚Äì0.5 (–¥–ª—è FCNet –∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–π CNN)\
augmentation: —Å–ª—É—á–∞–π–Ω—ã–µ —Å–¥–≤–∏–≥–∏, –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è\
loss: CrossEntropyLoss

- –°—Ä–∞–≤–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
```
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Å–µ–∫):
DeepFCNet:              718.84
ResNetCIFAR:            1169.86
ResNetCIFARRegularized: 1294.81

–¢–æ—á–Ω–æ—Å—Ç—å:
DeepFCNet:              Train acc: 0.4353 Test acc: 0.4781
ResNetCIFAR:            Train acc: 0.9105 Test acc: 0.8273
ResNetCIFARRegularized: Train acc: 0.7711 Test acc: 0.7934
```
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ\
ResNetCIFAR –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —è–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –Ω–∏–∑–∫–∏–µ –ø–æ—Ç–µ—Ä–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏, –Ω–æ –∑–∞–º–µ—Ç–Ω–æ —Ö—É–¥—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ –º–µ—Ä–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —ç–ø–æ—Ö.\
–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –≤ ResNetCIFARRegularized –ø–æ–º–æ–≥–∞–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ: —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É –æ–±—É—á–∞—é—â–∏–º–∏ –∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω—å—à–µ.\
DeepFCNet –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è, –Ω–æ –∏ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –≤—ã—Å–æ–∫–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è –¥–ª—è –∑–∞–¥–∞—á–∏.
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ confusion matrix

**DeepFCNet**
![](plots/cifar_comparison/conf_matrix_DeepFCNet.png)

**ResNetCIFAR**
![](plots/cifar_comparison/conf_matrix_ResNetCIFAR.png)

**ResNetCIFARRegularized**
![](plots/cifar_comparison/conf_matrix_ResNetCIFARRegularized.png)

- –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã (gradient flow)\
–°–µ—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ç–∏–ø–∏—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –≥–ª—É–±–æ–∫–∏—Ö –º–æ–¥–µ–ª–µ–π: –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∑–∞—Ç—É—Ö–∞—é—Ç –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –∫ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–º —Å–ª–æ—è–º, –Ω–æ –Ω–µ –∏—Å—á–µ–∑–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –æ–±—É—á–∞–µ–º–æ—Å—Ç—å—é. –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, –¥–µ–ª–∞—è –∏—Ö —á—É—Ç—å –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è —Ä–µ–∑–∫–∏–µ –≤—Å–ø–ª–µ—Å–∫–∏ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ—è—Ö.

# –ó–∞–¥–∞–Ω–∏–µ 2: –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä CNN (30 –±–∞–ª–ª–æ–≤)
## 2.1 –í–ª–∏—è–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —è–¥—Ä–∞ —Å–≤–µ—Ä—Ç–∫–∏ (15 –±–∞–ª–ª–æ–≤)
–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —è–¥—Ä–∞ —Å–≤–µ—Ä—Ç–∫–∏:
- 3x3 —è–¥—Ä–∞
- 5x5 —è–¥—Ä–∞
- 7x7 —è–¥—Ä–∞
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ (1x1 + 3x3)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
CNN_3x3: 20042
CNN_5x5: 19922
CNN_7x7: 18782
CNN_Combo: 19274
```
- –°—Ä–∞–≤–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏:
CNN_3x3:    train acc: 0.5329   test acc: 0.5329
CNN_5x5:    train acc: 0.5562   test acc: 0.5503
CNN_7x7:    train acc: 0.5460   test acc: 0.5445
CNN_Combo:  train acc: 0.4554   test acc: 0.4378

–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Å–µ–∫):
CNN_3x3: 584.58
CNN_5x5: 584.88
CNN_7x7: 588.64
CNN_Combo: 580.48
```
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ—Ü–µ–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è\
–†–∞–∑–º–µ—Ä —Ä–µ—Ü–µ–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—è –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∏–ª—å—Ç—Ä–∞: —á–µ–º –±–æ–ª—å—à–µ —Ñ–∏–ª—å—Ç—Ä, —Ç–µ–º –±–æ–ª—å—à–µ —á–∞—Å—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –Ω–µ–π—Ä–æ–Ω–∞.\
–ú–∞–ª—ã–µ —Ä–µ—Ü–µ–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è (3√ó3) ‚Äî –ª—É—á—à–µ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π –∏ —Ç–µ–∫—Å—Ç—É—Ä.\
–ë–æ–ª—å—à–∏–µ —Ä–µ—Ü–µ–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è (5√ó5, 7√ó7) ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∏ –∫–æ–Ω—Ç—É—Ä–æ–≤.\
–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ç–∏ –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –∫ –ø—Ä–∏–∑–Ω–∞–∫–∞–º —Ä–∞–∑–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è.

- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—è

**3x3**
![](plots/architecture_analysis/act_CNN_3x3.png)

**5x5**
![](plots/architecture_analysis/act_CNN_5x5.png)

**7x7**
![](plots/architecture_analysis/act_CNN_7x7.png)

**1x1 + 3x3**
![](plots/architecture_analysis/act_CNN_Combo.png)

## 2.2 –í–ª–∏—è–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã CNN (15 –±–∞–ª–ª–æ–≤)
–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –≤–ª–∏—è–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã CNN:
- –ù–µ–≥–ª—É–±–æ–∫–∞—è CNN (2 conv —Å–ª–æ—è)
- –°—Ä–µ–¥–Ω—è—è CNN (4 conv —Å–ª–æ—è)
- –ì–ª—É–±–æ–∫–∞—è CNN (6+ conv —Å–ª–æ–µ–≤)
- CNN —Å Residual —Å–≤—è–∑—è–º–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –°—Ä–∞–≤–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
```
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Å–µ–∫):
ShallowCNN: 806.29
MediumCNN: 3333.88
DeepCNN: 6332.97
ResidualCNN: 11413.16

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏:
ShallowCNN:     train acc: 0.4709   test acc: 0.4608
MediumCNN:      train acc: 0.6180   test acc: 0.6093
DeepCNN:        train acc: 0.6776   test acc: 0.6872
ResidualCNN:    train acc: 0.8504   test acc: 0.7883
```
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ vanishing/exploding gradients\
–ó–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç: —á–µ–º –≥–ª—É–±–∂–µ —Å–ª–æ–π, —Ç–µ–º –º–µ–Ω—å—à–µ —Å—Ä–µ–¥–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ ResidualCNN, –Ω–æ residual-—Å–≤—è–∑–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –ø–æ–ª–Ω–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –í ShallowCNN –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–æ —Å–∏–ª—å–Ω–µ–µ –º–µ–∂–¥—É —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–º–∏ —Å–ª–æ—è–º–∏, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª—è—Ç—å –æ–±—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å–ª–æ—ë–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –æ—á–µ–Ω—å –≥–ª—É–±–æ–∫–∏—Ö —Å–µ—Ç—è—Ö.\
–í–∑—Ä—ã–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ: –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ—Å–æ–≤ –∏ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.\
–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: —Ç–∞–∫–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–µ—Ç–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã –≤—Ä–æ–¥–µ ReLU, BatchNorm –∏ —Ö–æ—Ä–æ—à–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è. –û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å–≤—è–∑–∏ –≤ ResidualCNN –≤—ã–ø–æ–ª–Ω—è—é—Ç —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–∞–∂–µ –≤ –≥–ª—É–±–æ–∫–æ–π —Å–µ—Ç–∏. –í –Ω–µ–≥–ª—É–±–æ–∫–æ–π ShallowCNN –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –∏ –Ω–µ –º–µ—à–∞–µ—Ç –æ–±—É—á–µ–Ω–∏—é.

- –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å Residual —Å–≤—è–∑–µ–π\
Residual-—Å–≤—è–∑–∏ —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –≥–ª—É–±–æ–∫–∏—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–µ—Ç–µ–π: —É—Å–∫–æ—Ä—è—é—Ç —Ä–æ—Å—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç ResidualCNN –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ.

- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ feature maps

**ShallowCNN**
![](plots/architecture_analysis/fmap_ShallowCNN.png)

**MediumCNN**
![](plots/architecture_analysis/fmap_MediumCNN.png)

**DeepCNN**
![](plots/architecture_analysis/fmap_DeepCNN.png)

**ResidualCNN**
![](plots/architecture_analysis/fmap_ResidualCNN.png)

# –ó–∞–¥–∞–Ω–∏–µ 3: –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ª–æ–∏ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã (30 –±–∞–ª–ª–æ–≤)
## 3.1 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–ª–æ–µ–≤ (15 –±–∞–ª–ª–æ–≤)
–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ª–æ–∏:
- –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- Attention –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è CNN
- –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –ö–∞—Å—Ç–æ–º–Ω—ã–π pooling —Å–ª–æ–π

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è:
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ forward –∏ backward –ø—Ä–æ—Ö–æ–¥—ã\
Forward –ø—Ä–æ—Ö–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, backward –ø—Ä–æ—Ö–æ–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç autograd.

- –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ\
–í PyTorch –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç—ã —Ç–∏–ø–∞ nn.Parameter, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Å–ø–∏—Å–∫—É –æ–±—É—á–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–º.\
–¢–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - –º—ã –∏—Ö –¥–æ–±–∞–≤–ª—è–µ–º.

- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö
```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è 5 —ç–ø–æ—Ö:
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: 96.28 —Å–µ–∫
train_acc: 0.8582
test_acc:  0.8876
```
- –°—Ä–∞–≤–Ω–∏—Ç–µ —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∞–Ω–∞–ª–æ–≥–∞–º–∏
```
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π:
SimpleCNN: 131.26 —Å–µ–∫
CNNWithCustomLayers: 200.80 —Å–µ–∫
FCNet: 81.64 —Å–µ–∫

–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π
SimpleCNN:          train_acc: 0.9948   test_acc: 0.9880 (–º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∏–ª–∞—Å—å)
CNNWithCustomLayers train_acc: 0.8872   test_acc: 0.8962
FCNet:              train_acc: 0.9954   test_acc: 0.9806 (–º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∏–ª–∞—Å—å)
```

## 3.2 –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å Residual –±–ª–æ–∫–∞–º–∏ (15 –±–∞–ª–ª–æ–≤)
–ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã Residual –±–ª–æ–∫–æ–≤:
- –ë–∞–∑–æ–≤—ã–π Residual –±–ª–æ–∫
- Bottleneck Residual –±–ª–æ–∫
- Wide Residual –±–ª–æ–∫

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –±–ª–æ–∫ —Å –Ω—É–ª—è\
–í—ã–ø–æ–ª–Ω–µ–Ω–æ üëç
- –°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```
–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (—Å–µ–∫):
BasicResNet:        589.55
BottleneckResNet:   583.22
WideResNet:         602.42
```
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
BasicResNet:        304810
BottleneckResNet:    33770
WideResNet:         886762
```
BottleneckResNet ‚Äî —Å–∞–º–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –º–æ–¥–µ–ª—å, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á, –≥–¥–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏.\
BasicResNet ‚Äî –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Ä–∞–∑–º–µ—Ä–æ–º –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º, –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.\
WideResNet ‚Äî —Å–∞–º–∞—è "—Ç—è–∂—ë–ª–∞—è" –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —Å–∞–º–∞—è —Ç–æ—á–Ω–∞—è, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤.\
–ß–µ—Å—Ç–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ: Bottleneck-–±–ª–æ–∫–∏ –¥–∞—é—Ç —Å–∏–ª—å–Ω—É—é —ç–∫–æ–Ω–æ–º–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, Wide-–±–ª–æ–∫–∏ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞ —Å—á—ë—Ç —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ –∫–∞–Ω–∞–ª–æ–≤.

- –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è\
–í—Å–µ —Ç—Ä–∏ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ: loss –∏ accuracy –º–µ–Ω—è—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ, –Ω–µ—Ç –≤–∑—Ä—ã–≤–æ–≤/–∑–∞—Ç—É—Ö–∞–Ω–∏—è, –Ω–µ—Ç —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤.\
WideResNet ‚Äî —Å–∞–º–∞—è —É—Å—Ç–æ–π—á–∏–≤–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –æ–±—É—á–µ–Ω–∏—è –∏–∑ —Ç—Ä—ë—Ö.\
BottleneckResNet —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–ª–∏ –≥–ª—É–±–∏–Ω—ã, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Ç–∞–∫–æ–π –∂–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞, –∫–∞–∫ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.\
–í —Ü–µ–ª–æ–º, –æ–±—É—á–µ–Ω–∏–µ ResNet-–±–ª–æ–∫–æ–≤ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π.

